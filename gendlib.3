\."
\." $Id: gendlib.3,v 1.1.1.1 2001-04-25 21:01:50 garlick Exp $
\." $Source: /g/g0/achu/temp/genders-cvsbackup-full/genders/gendlib.3,v $
\." 
.\" Copyright (C) 2000 Regents of the University of California
.\" See the DISCLAIMER file distributed with this package.
\."
.TH GENDLIB 3 "10/10/97" "LLNL" "GENDLIB"
.SH NAME
gendlib \- perl library for querying genders file
.SH SYNOPSIS
require ``/admin/lib/gendlib.pl'';
.SH DESCRIPTION
This package contains common functions for manipulating the genders file.
Previously this code existed only in the nodeattr command, but applications
that must repeatedly call nodeattr would spend a great deal of time reading
and parsing the genders and other files.  These functions create an in-memory
cache of genders and other files on the first call;  subsequent calls need
only reference the in-memory copy and are thus speeded up.
.LP
.B Initialization:
.LP
Genders::init([$path_genders])
.IP
Function normally called internally for initialization.  It can be called
externally with a non-default genders file path and subsequent operations
will use this non-default data.  May be called more than once to change
genders files.  
.LP
.B Simple Queries:
.LP
Genders::hasattr($attribute, [$node])
.IP
Return 1 if node has attribute, 0 if not.  If node is not specified,
use local node.
.LP
Genders::getattrval($attribute, [$node])
.IP
Return value of attribute held by node, or empty string if no value or
node does not have attribute.  If node is not specified, use local node.
.LP
Genders::getnode($attribute)
.IP
Return a list of nodes having the specified attribute.  If a value is 
also specified ("attr=val"), only nodes with the specified attribute and
value are returned.
.LP
Genders::getattr([$node])
.IP
Return a list of attributes held by node.  If node is not specified, use
local node.
.LP
.B Complex Queries:
.LP
Genders::getallattr()
.IP
Return a list of all attributes in the genders file (one cluster only).
.LP
Genders::getnodehash(\\%node)
.IP
Get a copy of hash of attributes to node lists for the current cluster
(a "hash of lists").  Ensure that keys exist for all possible attributes 
across clusters (though they may point to empty lists).
.LP
Genders::get_clusters()
.IP
Return a copy of the list of clusters (from clusters file).  First 
element of list is the local cluster name or a null if unknown.
.LP
Genders::gendexp($exp, [$node])
.IP
Evaluate expression involving genders attributes and return the result
of the evaluation.  Any legal perl expresion using numeric constants,
genders attributes (which are converted into $variables), and the following
operators is valid:  !, ||, &&, *, +, -, /.  If $node is not specified,
assume the local host.
.LP
.B Conversion:
.LP
Genders::to_altnames()
.IP
Given a list of hostnames as they appear in the genders file, return
a list of alternate names.  On the SP, genders names are assumed to be the 
initial_hostnames, and we use the SDR to convert to reliable_hostnames.  
On other systems, we look for the value of the altname attribute in the 
genders file.
.LP
Genders::to_gendnames()
.IP
Performs the inverse of the to_altnames() function.
.SH "SEE ALSO"
nodeattr(1)
